<html>

<head>
  
  <script>
    let prom = import('./bmap.js')
    prom.then((bmap) => {
      console.log('bmap', bmap)

      // The query we constructed from step 2.
      let query = {
          "v": 3,
          "q": {
            "find": {
              "tx.h": {
                "$in": ["0272e1b230dfe2603a77469037ad04b32661261ec1453261ded793da0ce297f6", "46991bd7b30c136e41626e998fc04fab8830bb0a8fab8ae8410081426c3d6505", "6645b54733bf630597a89540bc336804d297161113a3290e4285c1bb5e54119b", "536dc444770e0841fbf1b7813e6b228d962a240677be8b778100fc01dfb7ae7d", "36b01a3216e3728b929356a5c4ed137ad4093e14b8d0d92d3d4080721c1c2321"]
              }
            }
          }
        }

        // Turn the query into base64 encoded string.
        // This is required for accessing a public bitdb node
        let b64 = btoa(JSON.stringify(query))
        let url = 'https://genesis.bitdb.network/q/1FnauZ9aUH2Bex6JzdcV4eNX7oLSSEbxtN/' + b64

        // Attach API KEY as header
        let header = {
          headers: { key: '14yHvrKQEosfAbkoXcEwY6wSvxNKteFbzU' }
        }

        // Make an HTTP request to bmap endpoint
        fetch(url, header).then((r) => {
          return r.json()
        }).then(async (r) => {
          for (tx of r.c) {
          console.log('raw:', tx)
          let bmapTx = bmap.default.TransformTx(tx)
          console.log('result', bmapTx)
          }
        })
      // let bmapTx = bmap.default.TransformTx(JSON.parse(localStorage.getItem('tx1')))
      // console.log('tx1', bmapTx)
      // bmapTx = bmap.default.TransformTx(JSON.parse(localStorage.getItem('tx2')))
      // console.log('tx2', bmapTx)
    })
    
    
  </script>

</head>
<body>

</body>
</html>